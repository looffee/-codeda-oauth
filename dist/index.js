!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("@codeda/oauth",["@angular/core","rxjs"],t):"object"==typeof exports?exports["@codeda/oauth"]=t(require("@angular/core"),require("rxjs")):e["@codeda/oauth"]=t(e["@angular/core"],e.rxjs)}(window,function(n,o){return function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){e.exports=n},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var u=e.length-1;0<=u;u--)(r=e[u])&&(c=(i<3?r(c):3<i?r(t,n,c):r(t,n))||c);return 3<i&&c&&Object.defineProperty(t,n,c),c},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(n,o){return function(e,t){o(e,t,n)}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),u=n(2),a=n(3);function f(e,t){var n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.src=e,n.innerHTML=t,{element:n,insert:function(){document.body.appendChild(n)}}}var l=function(){function e(e,t){this.zone=e,this.config=t,this.inited=!1}return e.prototype.canActivate=function(){var t=this;return"localhost"===location.hostname||!0===this.inited||a.Observable.create(function(e){a.forkJoin([t.initFacebookSdk(),t.initGoogleSdk(),t.initLinkedInSdk()]).subscribe(function(){t.inited=!0,t.zone.run(function(){e.next(!0),e.complete()})})})},e.prototype.initFacebookSdk=function(){var n=this;return a.Observable.create(function(e){var t=f("https://connect.facebook.net/en_US/sdk.js");t.element.id="facebook-jssdk",window.fbAsyncInit=function(){FB.init({appId:n.config.facebook.appId,autoLogAppEvents:!0,xfbml:!0,version:"v3.0"}),delete window.fbAsyncInit,e.next(void 0),e.complete()},t.insert()})},e.prototype.initGoogleSdk=function(){var n=this;return a.Observable.create(function(e){var t=f("https://apis.google.com/js/api.js");t.element.onload=function(){gapi.load("client",function(){gapi.client.init({discoveryDocs:["https://people.googleapis.com/$discovery/rest"],clientId:n.config.google.clientId,scope:"profile"}).then(function(){e.next(void 0),e.complete()})})},t.insert()})},e.prototype.initLinkedInSdk=function(){var n=this;return a.Observable.create(function(e){var t=f("//platform.linkedin.com/in.js","api_key: "+n.config.linkedIn.api_key+" \n onLoad: onLoadLinkedInSdk");window.onLoadLinkedInSdk=function(){delete window.onLoadLinkedInSdk,e.next(void 0),e.complete()},t.insert()})},e=o([c.Injectable(),i(1,c.Inject(u.CONFIG)),r("design:paramtypes",[c.NgZone,Object])],e)}();t.OAuthGuard=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.CONFIG=new o.InjectionToken("config")},function(e,t){e.exports=o},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var u=e.length-1;0<=u;u--)(r=e[u])&&(c=(i<3?r(c):3<i?r(t,n,c):r(t,n))||c);return 3<i&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),c=function(){function e(){}return e.prototype.signInByLinkedIn=function(){return i.Observable.create(function(n){IN.User.authorize(function(){IN.API.Profile("me").fields("first-name","last-name","email-address").result(function(e){var t=e.values[0];n.next({fullName:t.firstName+" "+t.lastName,email:t.emailAddress}),n.complete()}).error(function(e){n.error(e)})})})},e.prototype.signInByFacebook=function(){return i.Observable.create(function(t){FB.login(function(e){e.authResponse?FB.api("/me",{fields:"last_name,first_name,email"},function(e){t.next({fullName:e.first_name+" "+e.last_name,email:e.email}),t.complete()}):t.error(e)})})},e.prototype.signInByGoogle=function(){return i.Observable.create(function(t){var n=gapi.auth2.getAuthInstance(),e=new gapi.auth2.SigninOptionsBuilder;e.setPrompt("select_account"),n.signIn(e).then(function(){var e=n.currentUser.get().getBasicProfile();t.next({fullName:e.getName(),email:e.getEmail()})},function(e){return t.error(e)})})},e.prototype.logout=function(){"localhost"!==location.hostname&&(this.signOutByFacebook(),this.signOutByGoogle(),this.signOutByLinkedIn())},e.prototype.signOutByLinkedIn=function(){!0===IN.User.isAuthorized()&&IN.User.logout(function(){return null})},e.prototype.signOutByFacebook=function(){FB.getLoginStatus(function(e){"connected"===e.status&&FB.logout(function(){return null})})},e.prototype.signOutByGoogle=function(){!0===gapi.auth2.getAuthInstance().isSignedIn.get()&&gapi.auth2.getAuthInstance().signOut().then(function(){return null})},e=o([r.Injectable()],e)}();t.OAuthService=c},function(e,n,t){"use strict";function o(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),o(t(1)),o(t(6)),o(t(4))},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var u=e.length-1;0<=u;u--)(r=e[u])&&(c=(i<3?r(c):3<i?r(t,n,c):r(t,n))||c);return 3<i&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),c=n(4),u=n(2),a=function(){function e(){}var t;return(t=e).forRoot=function(e){return{ngModule:t,providers:[{provide:u.CONFIG,useValue:e},i.OAuthGuard,c.OAuthService]}},e=t=o([r.NgModule({})],e)}();t.OAuthModule=a}])});